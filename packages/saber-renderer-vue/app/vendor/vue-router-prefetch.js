/* https://unpkg.com/vue-router-prefetch@1.5.1/dist/index.mjs */
var e="undefined"!=typeof window,t=e&&navigator.connection,n=e&&(!t||-1===(t.effectiveType||"").indexOf("2g")&&!t.saveData),r=e&&window.IntersectionObserver,o={};function i(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,r.withCredentials=!0),r.addEventListener("load",function(){200===r.status?t():n()}),r.send()})}var s=function(t){if(e){var n=document.createElement("link");return n.relList&&n.relList.supports&&n.relList.supports(t)}}("prefetch")?function(e){return new Promise(function(t,n){var r=document.createElement("link");r.rel="prefetch",r.href=e,r.addEventListener("load",t),r.addEventListener("error",n),document.head.appendChild(r)})}:i;function c(e,t){if(n&&!o[e])return(t?function(e){return self.fetch?fetch(e,{credentials:"include"}):i(e)}:s)(e).then(function(){o[e]=!0})}function u(t,o){void 0===o&&(o={});var i=o.componentName;void 0===i&&(i="RouterLink");var s=o.prefetch;void 0===s&&(s=!0);var u=r&&new window.IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&e.target._linkPrefetch()})}),f=e&&window.requestIdleCallback||function(e){var t=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},a=t.component("RouterLink")||t.component("router-link");"development"!==process.env.NODE_ENV||a||console.error("[vue-router-prefetch] You need to call Vue.use(VueRouter) before this plugin!");var h={name:i,extends:a,props:{prefetch:{type:Boolean,default:s},prefetchFiles:{type:Array},timeout:{type:Number,default:2e3}},mounted:function(){this.prefetch&&u&&n&&f(this.observe,{timeout:this.timeout})},beforeDestory:function(){this.unobserve()},methods:{observe:function(){u.observe(this.$el),this.$el._linkPrefetch=this.linkPrefetch,this._linkObserved=!0},unobserve:function(){this._linkObserved&&u.unobserve(this.$el)},getComponents:function(){return this.$router.getMatchedComponents(this.to).filter(function(e){return"function"==typeof e})},linkPrefetch:function(){var e=this.$router.resolve(this.to).route;if(!e.meta.__prefetched){if(e.meta.__prefetched=!0,!1!==e.meta.prefetch)for(var t=0,n=this.getComponents();t<n.length;t+=1){var r=n[t];this.$emit("prefetch",this.to),r()}"function"==typeof e.meta.prefetch&&e.meta.prefetch(e);var o=(this.prefetchFiles||[]).concat(e.meta.prefetchFiles||[]);if(o.length>0)for(var i=0,s=o;i<s.length;i+=1){c(s[i])}this.unobserve()}}}};t.component(h.name,h)}export default u;export{c as prefetch,u as install};
